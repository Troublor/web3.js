!function(e,t){for(var n in t)e[n]=t[n];t.__esModule&&Object.defineProperty(e,"__esModule",{value:!0})}(window,(()=>{"use strict";var e={362:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(240),t),o(n(825),t)},240:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=void 0;var n=function(){function e(e,t){this.module=e,this.level=t}return e.prototype.parseLog=function(t,n,r){var o,a=new Date,i=a.getMonth().toString().padStart(2,"0")+"-"+a.getDay().toString().padStart(2,"0")+"|"+a.getHours().toString().padStart(2,"0")+":"+a.getMinutes().toString().padStart(2,"0")+":"+a.getSeconds().toString().padStart(2,"0")+"."+a.getMilliseconds().toString().padEnd(3,"0").slice(0,3),c=function(e,t){return t},s="";if(r)for(var u in r)r.hasOwnProperty(u)&&(s+=c(0,u)+"="+(null===(o=r[u])||void 0===o?void 0:o.toString())+" ");return c(0,e.Level.levelString(t).padEnd(5," "))+"["+i+"]["+this.module+"] "+n.padEnd(48," ")+" "+s},e.prototype.log=function(t,n,r){if(this.level<=t)switch(this.level){case e.Level.ERROR:console.error(this.parseLog(t,n,r));break;case e.Level.WARN:console.warn(this.parseLog(t,n,r));break;case e.Level.INFO:console.info(this.parseLog(t,n,r));break;case e.Level.DEBUG:console.debug(this.parseLog(t,n,r));break;default:console.log(this.parseLog(t,n,r))}},e.prototype.info=function(t,n){this.log(e.Level.INFO,t,n)},e.prototype.warn=function(t,n){this.log(e.Level.WARN,t,n)},e.prototype.debug=function(t,n){this.log(e.Level.DEBUG,t,n)},e.prototype.error=function(t,n){this.log(e.Level.ERROR,t,n)},e.Level={DEBUG:1,INFO:2,WARN:3,ERROR:4,levelString:function(e){switch(e){case 1:return"DEBUG";case 2:return"INFO";case 3:return"WARN";case 4:return"ERROR";default:return"UNKNOWN"}}},e}();t.Logger=n},825:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.prettifyHash=void 0,t.prettifyHash=function(e){var t=0;return e.startsWith("0x")&&(t=2),e.substring(t,t+6)+"â€¦"+e.substring(e.length-6,e.length)}},846:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function c(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}s((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.traceSend=t.traceSendAsync=t.getStackTraceByCrawljax=void 0;var a=n(362),i=new a.Logger("Trace",a.Logger.Level.INFO);function c(e,t){return r(this,void 0,void 0,(function(){return o(this,(function(n){return[2,new Promise((function(n,r){var o=new WebSocket(e);o.onopen=function(){o.send(JSON.stringify(t))},o.onerror=function(e){r(e)},o.onmessage=function(e){var t=JSON.parse(e.data);n(t),o.close()}}))]}))}))}function s(e,t){if("eth_sendTransaction"===e||"eth_sendRawTransaction"===e){var n={stack:void 0};Error.captureStackTrace(n,s),t=new Proxy(t,{apply:function(e,t,r){var o={hash:r[1],stack:n.stack.split(/\n/).map((function(e){return e.trim()})).filter((function(e){return e.length>0&&"Error"!==e}))};i.info("Transaction trace",{hash:a.prettifyHash(o.hash),stack:o.stack});var c=new WebSocket("ws://localhost:1236");c.onopen=function(){c.send(JSON.stringify(o))},c.onerror=function(e){i.error("Send transaction trace error",{err:e})},c.onmessage=function(){c.close()},e.apply(t,r)}})}return t}t.getStackTraceByCrawljax=function(){return r(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,c("ws://localhost:1237",{type:"FetchStackTrace",stack:[]})];case 1:return[2,e.sent().stack]}}))}))},t.traceSendAsync=s,t.traceSend=function(e,t){if("eth_sendTransaction"===e||"eth_sendRawTransaction"===e){var n={stack:void 0};Error.captureStackTrace(n,s);var r={hash:t,stack:n.stack.split(/\n/).map((function(e){return e.trim()})).filter((function(e){return e.length>0&&"Error"!==e}))};i.info("Transaction trace",{hash:a.prettifyHash(r.hash),stack:r.stack});var o=new WebSocket("ws://localhost:1236");o.onopen=function(){o.send(JSON.stringify(r))},o.onerror=function(e){i.error("Send transaction trace error",{err:e})},o.onmessage=function(){o.close()}}}}},t={};return function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}(846)})());
//# sourceMappingURL=trace-instrument.js.map